@()
<div ng-controller="DrillDownController" ng-init="sortField = 'label'; sortDesc = false; refreshTree()" style="width: 100%">
	<div>
        <div ng-controller="DiscoverController">@assets.views.html.discover.SectorIndustry()</div>
		<div style="display: block">
			<div class="drill_down_title">
				Assets by Sector <i class="fa fa-sort{{ sortDesc == null ? '' : (sortDesc ? '-desc' : '-asc') }} clickable" ng-click="sortDesc = !sortDesc"></i>
				
				<!-- ordering: label/total -->
				<span style="float: right; padding-right: 5px" class="clickable" ng-click="sortField = (sortField === 'label') ? 'total' : 'label'">
					Sort By: <span style="font-weight: bold; color: #ff9940">{{ sortField === 'label' ? 'Sectors' : 'Assets' }}</span>
				</span>
			</div>

			<div ng-repeat="sector in getSectors() | orderBy:sortField:sortDesc" class="pad-left-10">
				<img ng-show="sector.loading" src="/assets/images/status/loading16.gif">
				<a ng-click="expandOrCollapseSector(sector)">
					<i ng-hide="sector.loading" class="fa st_control" ng-class="sector.expanded ? 'fa-minus-square' : 'fa-plus-square'"></i>
					<span class="sector_H">{{ sector.label }}</span>
				</a>
				<span class="null center">(<span style="color: blue">{{ sector.total }}</span>)</span>
			
				<div ng-if="sector.expanded && sector.industries" class="pad-left-20"
                     ng-repeat="industry in sector.industries | orderBy:'label'">
					<img ng-show="industry.loading" src="/assets/images/status/loading16.gif">
					<a ng-click="expandOrCollapseIndustry(sector, industry)">
						<i ng-hide="industry.loading" class="fa st_control" ng-class="industry.expanded ? 'fa-minus-square' : 'fa-plus-square'"></i>
						<span class="industry_H">{{ industry.label }}</span>
					</a>
					<span class="null center">(<span class="st_blue">{{ industry.total }}</span>)</span>
				
					<div ng-if="industry.expanded && industry.subIndustries.length > 0" class="pad-left-20"
                         ng-repeat="subIndustry in industry.subIndustries | orderBy:'label'">
						<img ng-show="subIndustry.loading" src="/assets/images/status/loading16.gif">
						<a ng-click="expandOrCollapseSubIndustry(sector, industry, subIndustry)">
							<i ng-hide="subIndustry.loading" class="fa st_control" ng-class="subIndustry.expanded ? 'fa-minus-square' : 'fa-plus-square'"></i>
							<span class="sub_industry_H">{{ subIndustry.label }}</span>
						</a>
						<span class="null center">(<span style="color: blue">{{ subIndustry.total }}</span>)</span>
					
						<div ng-if="subIndustry.expanded && subIndustry.quotes.length > 0" class="pad-left-20">
							<!--  heading -->
							<div>
								<i class="fa fa-globe st_text_color"></i>
								<span class="sector_H">{{ sector.label }}</span> 
								<i class="fa fa-chevron-circle-right st_control"></i>
								<span class="industry_H">{{ industry.label }}</span>
								<i class="fa fa-chevron-circle-right st_control"></i>
								<span class="sub_industry_H">{{ subIndustry.label }}</span>
							</div>
							
							<table class="results">
								<tr>
									<th class="results">Symbol</th>
									<th class="results_num">Last</th>
									<th class="results_num">Open</th>
									<th class="results_num">Close</th>
									<th class="results_num">Chg %</th>
									<th class="results_num">Low</th>
									<th class="results_num">High</th>
									<th class="results_num">Spread %</th>
									<th class="results_bignum">Volume</th>
								</tr>					
								<tr ng-repeat="quote in subIndustry.quotes | orderBy:'symbol'" ng-class="quote.symbol === selectedSymbol() ? 'selected' : ''">
									<td class="results">
										<a class="links" ng-href="#/discover/{{ quote.symbol }}">
											<i ng-class="getPreferenceIcon(row)"></i>
											<span ng-class="quote.exchange"
												popover="{{ quote.name }}" 
												popover-placement="right"
												popover-trigger="mouseenter">{{ quote.symbol }}</span>
										</a>
									</td>
									<td class="results_num">
										<span ng-show="quote.lastTrade != null">{{ quote.lastTrade | quoteNumber }}</span>
										<span ng-show="quote.lastTrade == null" class="null center">&#8212;</span>
									</td>					
									<td class="results_num">
										<span ng-show="quote.open != null">{{ quote.open | quoteNumber }}</span>
										<span ng-show="quote.open == null" class="null center">&#8212;</span>
									</td>
									<td class="results_num">
										<span ng-show="quote.close != null">{{ quote.close | quoteNumber }}</span>
										<span ng-show="quote.close == null" class="null center">&#8212;</span>														
									</td>
									<td class="results_num">
										<span ng-show="quote.changePct != null" ng-class="quote.changePct < 0 ? 'negative' : ''">{{ quote.changePct | number:1 }}</span>
										<span ng-show="quote.changePct == null" class="null center">&#8212;</span>		
										<changearrow ng-show="quote.changePct != null" value="{{ quote.changePct }}">
									</td>
									<td class="results_num">
										<span ng-show="quote.low != null">{{ quote.low | quoteNumber }}</span>
										<span ng-show="quote.low == null" class="null center">&#8212;</span>															
									</td>
									<td class="results_num">
										<span ng-show="quote.high != null">{{ quote.high | quoteNumber }}</span>
										<span ng-show="quote.high == null" class="null center">&#8212;</span>														
									</td>
									<td class="results_num">
										<span ng-show="quote.spread != null" ng-class="quote.spread > 50 ? 'positive' : ''">{{ quote.spread | number:2 }}</span>
										<span ng-show="quote.spread == null" class="null center">&#8212;</span>														
									</td>
									<td class="results_bignum">
										<span ng-show="quote.volume != null">{{ quote.volume | number }}</span>
										<span ng-show="quote.volume == null" class="null center">&#8212;</span>													
									</td>					
								</tr>
							</table>							
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>